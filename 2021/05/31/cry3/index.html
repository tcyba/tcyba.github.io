<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>cry3 | upload</title><meta name="author" content="upload"><meta name="copyright" content="upload"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="cry3">
<meta property="og:type" content="article">
<meta property="og:title" content="cry3">
<meta property="og:url" content="http://upload.love/2021/05/31/cry3/index.html">
<meta property="og:site_name" content="upload">
<meta property="og:description" content="cry3">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://upload.love/image/buu.png">
<meta property="article:published_time" content="2021-05-31T08:31:31.000Z">
<meta property="article:modified_time" content="2021-06-01T03:46:09.752Z">
<meta property="article:author" content="upload">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://upload.love/image/buu.png"><link rel="shortcut icon" href="/%E7%94%B7%E5%AD%A9.png"><link rel="canonical" href="http://upload.love/2021/05/31/cry3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-06-01 11:46:09'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'true'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="upload" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/image/pp.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">139</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">132</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> â™¥â™¥â™¥</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> ç›®å½•</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/2.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">upload</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> â™¥â™¥â™¥</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> ç›®å½•</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å¨±ä¹</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">cry3</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-05-31T08:31:31.000Z" title="å‘è¡¨äº 2021-05-31 16:31:31">2021-05-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-06-01T03:46:09.752Z" title="æ›´æ–°äº 2021-06-01 11:46:09">2021-06-01</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">1.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>8åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="NCTF2019-childRSA"><a href="#NCTF2019-childRSA" class="headerlink" title="[NCTF2019]childRSA"></a>[NCTF2019]childRSA</h1><h2 id="çŸ¥è¯†ç‚¹ï¼šåˆ†è§£n"><a href="#çŸ¥è¯†ç‚¹ï¼šåˆ†è§£n" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼šåˆ†è§£n"></a>çŸ¥è¯†ç‚¹ï¼šåˆ†è§£n</h2><p>æ„Ÿè§‰ç”¨py2å¥½ç‚¹ï¼ py3è€å‡ºé—®é¢˜ï¼</p>
<p>è¿™ä¸ªä¸ç”¨yayuåˆ†è§£ï¼ æˆ‘å°±çœŸäººå‚»äº†ï¼ğŸ™„</p>
<p>ä¸è¿‡èƒ½åˆ†è§£ï¼ çœŸçš„ç¥å¥‡ï¼</p>
<p>ok</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2021/5/31 16:36</span></span><br><span class="line"><span class="comment"># @Author  : upload</span></span><br><span class="line"><span class="comment"># @File    : [NCTF2019]childRSA.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">p = <span class="number">178449493212694205742332078583256205058672290603652616240227340638730811945224947826121772642204629335108873832781921390308501763661154638696935732709724016546955977529088135995838497476350749621442719690722226913635772410880516639651363626821442456779009699333452616953193799328647446968707045304702547915799734431818800374360377292309248361548868909066895474518333089446581763425755389837072166970684877011663234978631869703859541876049132713490090720408351108387971577438951727337962368478059295446047962510687695047494480605473377173021467764495541590394732685140829152761532035790187269724703444386838656193674253139</span></span><br><span class="line">q = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">184084121540115307597161367011014142898823526027674354555037785878481711602257307508985022577801782788769786800</span></span><br><span class="line"><span class="string">015984410443717799994642236194840684557538917849420967360121509675348296203886340264385224150964642958965438801864306187</span></span><br><span class="line"><span class="string">503790100281099130863977710204660546799128755418521327290719635075221585824217487386227004673527292281536221958961760681</span></span><br><span class="line"><span class="string">032293340099395863194031788435142296085219594866635192464353365034089592414809332183882423461536123972873871477755949082</span></span><br><span class="line"><span class="string">223830049594561329457349537703926325152949582123419049073013144325689632055433283354999265193117288252918515308767016885</span></span><br><span class="line"><span class="string">678802217366700376654365502867&#x27;&#x27;&#x27;</span></span><br><span class="line">q = gmpy2.mpz(q)</span><br><span class="line">n = <span class="number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br><span class="line">fn = (q<span class="number">-1</span>)*(p<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, fn)</span><br><span class="line"></span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line">print(binascii.unhexlify(hex(m)[<span class="number">2</span>:]))</span><br><span class="line">print(libnum.n2s(m).replace(<span class="string">&#x27;NCTF&#x27;</span>,<span class="string">&quot;flag&quot;</span>))</span><br></pre></td></tr></table></figure>



<h1 id="HDCTF2019-bbbbbbrsa"><a href="#HDCTF2019-bbbbbbrsa" class="headerlink" title="[HDCTF2019]bbbbbbrsa"></a>[HDCTF2019]bbbbbbrsa</h1><h2 id="çŸ¥è¯†ç‚¹ï¼šRSA"><a href="#çŸ¥è¯†ç‚¹ï¼šRSA" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼šRSA"></a>çŸ¥è¯†ç‚¹ï¼šRSA</h2><p>å†™è„šæœ¬æœ¬æ¥æƒ³è‡ªå·±æ‰¾å‘¢ï¼ ä½†æ˜¯ä¸è¡Œï¼è¿™py byte å’Œ å­—ç¬¦ 16è¿›åˆ¶ è½¬çš„å¤´æ™•äº†ï¼è¿˜æ˜¯å†™æ–‡ä»¶å¥½ï¼è€Œä¸”py3ä¸è¡Œï¼åªèƒ½py2ï¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"> <span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert, gcd, iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex, b2a_hex</span><br><span class="line"></span><br><span class="line">s = <span class="string">&#x27;==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM&#x27;</span></span><br><span class="line">s = s[::<span class="number">-1</span>]</span><br><span class="line">c = base64.b64decode(s)</span><br><span class="line">cc = <span class="number">2373740699529364991763589324200093466206785561836101840381622237225512234632</span></span><br><span class="line">p = gmpy2.mpz(<span class="number">177077389675257695042507998165006460849</span>)</span><br><span class="line">n = gmpy2.mpz(<span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span>)</span><br><span class="line"></span><br><span class="line">q = gmpy2.mpz(n // p)</span><br><span class="line"></span><br><span class="line">fn = gmpy2.mpz((q - <span class="number">1</span>) * (p - <span class="number">1</span>))</span><br><span class="line">flag = open(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> range(<span class="number">50000</span>,<span class="number">70001</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = invert(e, fn)</span><br><span class="line">        <span class="comment"># if libnum.n2s(pow(cc, d, n)).find(&#x27;flag&#123;&#x27;):</span></span><br><span class="line">        <span class="comment">#     print(libnum.n2s(pow(cc, d, n)))</span></span><br><span class="line">        flag.write(libnum.n2s(pow(cc, d, n)))</span><br><span class="line">        print(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<h1 id="BJDCTF2020-RSA"><a href="#BJDCTF2020-RSA" class="headerlink" title="[BJDCTF2020]RSA"></a>[BJDCTF2020]RSA</h1><h2 id="çŸ¥è¯†ç‚¹ï¼š-nå› å¼åˆ†è§£-çˆ†ç ´e"><a href="#çŸ¥è¯†ç‚¹ï¼š-nå› å¼åˆ†è§£-çˆ†ç ´e" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š nå› å¼åˆ†è§£  çˆ†ç ´e"></a>çŸ¥è¯†ç‚¹ï¼š nå› å¼åˆ†è§£  çˆ†ç ´e</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2021/5/31 17:49</span></span><br><span class="line"><span class="comment"># @Author  : upload</span></span><br><span class="line"><span class="comment"># @File    : [BJDCTF2020]RSA.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">n2 = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;gcd(n1, n2):\n&#x27;</span>, p</span><br><span class="line">q1 = n1 / p</span><br><span class="line">q2 = n2 / p</span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;q1 is:\n&#x27;</span>, q1</span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;q2 is:\n&#x27;</span>, q2</span><br><span class="line"></span><br><span class="line">fn = (p<span class="number">-1</span>)*(q1<span class="number">-1</span>)</span><br><span class="line">c = <span class="number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span></span><br><span class="line"><span class="comment"># for e in range(100000):</span></span><br><span class="line"><span class="comment">#     if pow(294,e,n1) ==381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018:</span></span><br><span class="line"><span class="comment">#         print(e)</span></span><br><span class="line">e = <span class="number">52361</span></span><br><span class="line">d = gmpy2.invert(e, fn)</span><br><span class="line">m = pow(c,d,n1)</span><br><span class="line">print(binascii.unhexlify(hex(m)[<span class="number">2</span>:]))</span><br><span class="line">print(libnum.n2s(m).replace(<span class="string">&#x27;BJD&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="BJDCTF2020-rsa-output"><a href="#BJDCTF2020-rsa-output" class="headerlink" title="[BJDCTF2020]rsa_output"></a>[BJDCTF2020]rsa_output</h1><h2 id="çŸ¥è¯†ç‚¹ï¼šå…±æ¨¡æ”»å‡»-å‘ç°nä¸€æ ·"><a href="#çŸ¥è¯†ç‚¹ï¼šå…±æ¨¡æ”»å‡»-å‘ç°nä¸€æ ·" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼šå…±æ¨¡æ”»å‡» å‘ç°nä¸€æ ·"></a>çŸ¥è¯†ç‚¹ï¼šå…±æ¨¡æ”»å‡» å‘ç°nä¸€æ ·</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment">#!/bin/python2</span></span><br><span class="line"><span class="comment"># -*- coding: cp936 -*- import time</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line">e = [<span class="number">2767</span>, <span class="number">3659</span>]</span><br><span class="line">c = [<span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span>, <span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span>]</span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;[+]Detecting m...&#x27;</span></span><br><span class="line">time.clock()</span><br><span class="line">c1 = c[<span class="number">0</span>]</span><br><span class="line">c2 = c[<span class="number">1</span>]</span><br><span class="line">e1 = e[<span class="number">0</span>]</span><br><span class="line">e2 = e[<span class="number">1</span>]</span><br><span class="line">s = gmpy2.gcdext(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="comment"># æ±‚æ¨¡åå…ƒç´ </span></span><br><span class="line"><span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">    s1 = -s1</span><br><span class="line">    c1 = gmpy2.invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">    s2 = -s2</span><br><span class="line">    c2 = gmpy2.invert(c2, n)</span><br><span class="line">m = pow(c1, s1, n) * pow(c2, s2, n) % n</span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27; [-]m is:&#x27;</span> + <span class="string">&#x27;&#123;:x&#125;&#x27;</span>.format(int(m)).decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;\n[!]Timer:&#x27;</span>, round(time.clock(),<span class="number">2</span>), <span class="string">&#x27;s&#x27;</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;[!]All Done!&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2021/5/31 18:36</span></span><br><span class="line"><span class="comment"># @Author  : upload</span></span><br><span class="line"><span class="comment"># @File    : [BJDCTF2020]rsa_output.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">import</span>  binascii</span><br><span class="line"><span class="keyword">import</span>  rsa</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exgcd</span>(<span class="params">m, n, x, y</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> (m, x, y)</span><br><span class="line">    a1 = b = <span class="number">1</span></span><br><span class="line">    a = b1 = <span class="number">0</span></span><br><span class="line">    c = m</span><br><span class="line">    d = n</span><br><span class="line">    q = int(c / d)</span><br><span class="line">    r = c % d</span><br><span class="line">    <span class="keyword">while</span> r:</span><br><span class="line">        c = d</span><br><span class="line">        d = r</span><br><span class="line">        t = a1</span><br><span class="line">        a1 = a</span><br><span class="line">        a = t - q * a</span><br><span class="line">        t = b1</span><br><span class="line">        b1 = b</span><br><span class="line">        b = t - q * b</span><br><span class="line">        q = int(c / d)</span><br><span class="line">        r = c % d</span><br><span class="line">    x = a</span><br><span class="line">    y = b</span><br><span class="line">    <span class="keyword">return</span> (d, x, y)<span class="comment">#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span></span><br><span class="line">c1=<span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line">c2=<span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br><span class="line">e1=<span class="number">2767</span></span><br><span class="line">e2=<span class="number">3659</span></span><br><span class="line">n=<span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line"></span><br><span class="line">ans=exgcd(e1,e2,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">print(ans)</span><br><span class="line">s1=ans[<span class="number">1</span>]</span><br><span class="line">s2=ans[<span class="number">2</span>]</span><br><span class="line">m=(gmpy2.powmod(c1,s1,n)*gmpy2.powmod(c2,s2,n))%n<span class="comment">#powmod()å‡½æ•°çœŸé¦™,åˆ†æ•°å–æ¨¡ä¹Ÿå¯ç›´æ¥ç®—,ä¸€å¼€å§‹ä¸çŸ¥é“è¿˜å»æ‰¾äº†å¾ˆå¤šçš„ç®—æ³•çŸ¥è¯†</span></span><br><span class="line">print(binascii.unhexlify(hex(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="MRCTF2020-keyboard"><a href="#MRCTF2020-keyboard" class="headerlink" title="[MRCTF2020]keyboard"></a>[MRCTF2020]keyboard</h1><h2 id="çŸ¥è¯†ç‚¹ï¼š9æ‰‹æœºé”®ç›˜"><a href="#çŸ¥è¯†ç‚¹ï¼š9æ‰‹æœºé”®ç›˜" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š9æ‰‹æœºé”®ç›˜"></a>çŸ¥è¯†ç‚¹ï¼š9æ‰‹æœºé”®ç›˜</h2><p>è¿™é¢˜æœ‰bugï¼æœ€åä¸€ä¸ª3å°±å‡ºç°ä¸€æ¬¡ åº”è¯¥æ˜¯dæ‰å¯¹å‘€ï¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: cp936 -*- import time</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a = []</span></span><br><span class="line"><span class="comment"># st = &#x27;ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee&#x27;</span></span><br><span class="line"><span class="comment"># st = st.replace(&#x27; &#x27;,&#x27;,&#x27;)</span></span><br><span class="line"><span class="comment"># all = &#123;&#x27;none1&#x27;:&#x27;&#x27;,&#x27;none2&#x27;:&#x27;&#x27;,&#x27;w&#x27;:&#x27;abc&#x27;,&#x27;e&#x27;:&#x27;def&#x27;,&#x27;r&#x27;:&#x27;ghi&#x27;,&#x27;t&#x27;:&#x27;jkl&#x27;,&#x27;y&#x27;:&#x27;mno&#x27;,&#x27;u&#x27;:&#x27;pors&#x27;,&#x27;i&#x27;:&#x27;tuv&#x27;,&#x27;o&#x27;:&#x27;wxyz&#x27;&#125;</span></span><br><span class="line"><span class="comment"># st = st.split(&#x27;,&#x27;)</span></span><br><span class="line"><span class="comment"># print(st)</span></span><br><span class="line"><span class="comment"># flag = &#x27;&#x27;</span></span><br><span class="line"><span class="comment"># for i in st:</span></span><br><span class="line"><span class="comment">#     print(i[0])</span></span><br><span class="line"><span class="comment">#     print(len(i))</span></span><br><span class="line"><span class="comment">#     print(all[i[0]][len(i)-1])</span></span><br><span class="line"><span class="comment">#     flag += all[i[0]][len(i)-1]</span></span><br><span class="line"><span class="comment"># print(&#x27;flag&#123;&#x27;+flag+&#x27;&#125;&#x27;)</span></span><br><span class="line"></span><br><span class="line">key = &#123;<span class="string">&#x27;2&#x27;</span>:<span class="string">&#x27;abc&#x27;</span>,<span class="string">&#x27;3&#x27;</span>:<span class="string">&#x27;def&#x27;</span>,<span class="string">&#x27;4&#x27;</span>:<span class="string">&#x27;ghi&#x27;</span>,<span class="string">&#x27;5&#x27;</span>:<span class="string">&#x27;jkl&#x27;</span>,<span class="string">&#x27;6&#x27;</span>:<span class="string">&#x27;mno&#x27;</span>,<span class="string">&#x27;7&#x27;</span>:<span class="string">&#x27;pqrs&#x27;</span>,<span class="string">&#x27;8&#x27;</span>:<span class="string">&#x27;tuv&#x27;</span>,<span class="string">&#x27;9&#x27;</span>:<span class="string">&#x27;wxyz&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">all= [<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;666&#x27;</span>,<span class="string">&#x27;22&#x27;</span>,<span class="string">&#x27;444&#x27;</span>,<span class="string">&#x27;555&#x27;</span>,<span class="string">&#x27;33&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;44&#x27;</span>,<span class="string">&#x27;666&#x27;</span>,<span class="string">&#x27;66&#x27;</span>,<span class="string">&#x27;33&#x27;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> all:</span><br><span class="line">    print(i[<span class="number">0</span>])</span><br><span class="line">    print(len(i))</span><br><span class="line"></span><br><span class="line">    print(key[i[<span class="number">0</span>]][len(i)<span class="number">-1</span>])</span><br><span class="line">    flag +=key[i[<span class="number">0</span>]][len(i)<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;flag&#123;&#x27;</span>+flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">#flag&#123;mobilephone&#125;</span></span><br></pre></td></tr></table></figure>





<h1 id="SameMod"><a href="#SameMod" class="headerlink" title="SameMod"></a>SameMod</h1><h2 id="çŸ¥è¯†ç‚¹ï¼šrsa-å…±æ¨¡æ”»å‡»"><a href="#çŸ¥è¯†ç‚¹ï¼šrsa-å…±æ¨¡æ”»å‡»" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼šrsa å…±æ¨¡æ”»å‡»"></a>çŸ¥è¯†ç‚¹ï¼šrsa å…±æ¨¡æ”»å‡»</h2><p>æœ‰çš„æ—¶å€™mæ˜¯asciiä¸èƒ½ç›´æ¥hexè½¬å­—ç¬¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2021/5/31 18:36</span></span><br><span class="line"><span class="comment"># @Author  : upload</span></span><br><span class="line"><span class="comment"># @File    : [BJDCTF2020]rsa_output.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">import</span>  gmpy2</span><br><span class="line"><span class="keyword">import</span>  binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="comment"># import  rsa</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exgcd</span>(<span class="params">m, n, x, y</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> (m, x, y)</span><br><span class="line">    a1 = b = <span class="number">1</span></span><br><span class="line">    a = b1 = <span class="number">0</span></span><br><span class="line">    c = m</span><br><span class="line">    d = n</span><br><span class="line">    q = int(c / d)</span><br><span class="line">    r = c % d</span><br><span class="line">    <span class="keyword">while</span> r:</span><br><span class="line">        c = d</span><br><span class="line">        d = r</span><br><span class="line">        t = a1</span><br><span class="line">        a1 = a</span><br><span class="line">        a = t - q * a</span><br><span class="line">        t = b1</span><br><span class="line">        b1 = b</span><br><span class="line">        b = t - q * b</span><br><span class="line">        q = int(c / d)</span><br><span class="line">        r = c % d</span><br><span class="line">    x = a</span><br><span class="line">    y = b</span><br><span class="line">    <span class="keyword">return</span> (d, x, y)<span class="comment">#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span></span><br><span class="line">c1=<span class="number">3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span></span><br><span class="line">c2=<span class="number">5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span></span><br><span class="line">e1=<span class="number">773</span></span><br><span class="line">e2=<span class="number">839</span></span><br><span class="line">n=<span class="number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span></span><br><span class="line"></span><br><span class="line">ans=exgcd(e1,e2,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">print(ans)</span><br><span class="line">s1=ans[<span class="number">1</span>]</span><br><span class="line">s2=ans[<span class="number">2</span>]</span><br><span class="line">m=(gmpy2.powmod(c1,s1,n)*gmpy2.powmod(c2,s2,n))%n<span class="comment">#powmod()å‡½æ•°çœŸé¦™,åˆ†æ•°å–æ¨¡ä¹Ÿå¯ç›´æ¥ç®—,ä¸€å¼€å§‹ä¸çŸ¥é“è¿˜å»æ‰¾äº†å¾ˆå¤šçš„ç®—æ³•çŸ¥è¯†</span></span><br><span class="line">print(m)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">result = str(m)</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; len(result):</span><br><span class="line">    print(<span class="string">&#x27;i:&#x27;</span>,i)</span><br><span class="line">    <span class="keyword">if</span>(result[i]==<span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">        flag +=chr(int(result[i:i+<span class="number">3</span>]))</span><br><span class="line">        i+=<span class="number">3</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=chr(int(result[i:i+<span class="number">2</span>]))</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line"></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment"># print(binascii.unhexlify(hex(m)[2:]))</span></span><br><span class="line"><span class="comment"># print(libnum.n2s(m))</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="GWCTF-2019-BabyRSA"><a href="#GWCTF-2019-BabyRSA" class="headerlink" title="[GWCTF 2019]BabyRSA"></a>[GWCTF 2019]BabyRSA</h1><p>çŸ¥è¯†ç‚¹ï¼šç›´æ¥åˆ†è§£N å†çœ‹çœ‹åŠ å¯†è„šæœ¬è§£å¯†ï¼</p>
<p>åªæœ‰py2æ‰è¡Œï¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment">#!/bin/python2</span></span><br><span class="line"><span class="comment"># -*- coding: cp936 -*- import time</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">source_text = <span class="string">&#x27;flag&#123;adadada&#125;&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;adadadadadadadadwdsssdwdadaadadad&#x27;</span></span><br><span class="line">f = bytes_to_long(<span class="string">&quot;string&quot;</span>)</span><br><span class="line"><span class="comment"># print(binascii.unhexlify(hex(f)[2:]))</span></span><br><span class="line">print(libnum.n2s(f))</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="WUSTCTF2020-babyrsa"><a href="#WUSTCTF2020-babyrsa" class="headerlink" title="[WUSTCTF2020]babyrsa"></a>[WUSTCTF2020]babyrsa</h1><h2 id="çŸ¥è¯†ç‚¹ï¼šç®€å•RSA"><a href="#çŸ¥è¯†ç‚¹ï¼šç®€å•RSA" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼šç®€å•RSA"></a>çŸ¥è¯†ç‚¹ï¼šç®€å•RSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2021/5/31 20:16</span></span><br><span class="line"><span class="comment"># @Author  : upload</span></span><br><span class="line"><span class="comment"># @File    : [GWCTF 2019]BabyRSA.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> solve, Eq</span><br><span class="line"><span class="keyword">from</span>  sympy.abc <span class="keyword">import</span> x,y,z</span><br><span class="line">p = <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span></span><br><span class="line">q = <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737</span></span><br><span class="line">n=<span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">fn = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, fn)</span><br><span class="line">c1 =pow(m1,d,n)</span><br><span class="line">c2 = pow(m2,d,n)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># lis = solve([Eq(x+y, c1), Eq(pow(x,3) + pow(y,3), c2)], [x, y])</span></span><br><span class="line"><span class="comment"># F1 = lis[0][0]</span></span><br><span class="line"><span class="comment"># F2 = lis[0][1]</span></span><br><span class="line"><span class="comment"># print(F1)</span></span><br><span class="line">F1=<span class="number">1141553212031156130619789508463772513350070909</span></span><br><span class="line">F2=<span class="number">1590956290598033029862556611630426044507841845</span></span><br><span class="line">print(type(F1))</span><br><span class="line">a = str(F1)+str(F2)</span><br><span class="line">print(a)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">result = str(a)</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(hex(F1)[<span class="number">2</span>:]))</span><br><span class="line">a =libnum.n2s(F2)+libnum.n2s(F1)</span><br><span class="line">print(str(a).replace(<span class="string">&#x27;GWHT&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>))</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(F1)+long_to_bytes(F2))</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: cp936 -*- import time</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">c = <span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line">n = <span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">q =<span class="number">189239861511125143212536989589123569301</span></span><br><span class="line">p =<span class="number">386123125371923651191219869811293586459</span></span><br><span class="line">fn = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, fn)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m).replace(<span class="string">&#x27;wctf2020&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">upload</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://upload.love/2021/05/31/cry3/">http://upload.love/2021/05/31/cry3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://upload.love" target="_blank">upload</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/image/buu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/01/cry4/"><img class="prev-cover" data-lazy-src="/image/buu.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">cry4</div></div></a></div><div class="next-post pull-right"><a href="/2021/05/29/DozerCTF-2021/"><img class="next-cover" data-lazy-src="/image/buu.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">DozerCTF 2021</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/image/pp.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">upload</div><div class="author-info__description">æ¯å¤©éƒ½è¦å¼€å¿ƒ</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">139</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">132</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://tcyba.github.io/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/tcyba" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2384372932@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æˆ‘å¸Œæœ›æˆ‘ä»¥åæ¯å¤©éƒ½èƒ½å¼€å¼€å¿ƒå¿ƒï¼</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NCTF2019-childRSA"><span class="toc-number">1.</span> <span class="toc-text">[NCTF2019]childRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%88%86%E8%A7%A3n"><span class="toc-number">1.1.</span> <span class="toc-text">çŸ¥è¯†ç‚¹ï¼šåˆ†è§£n</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HDCTF2019-bbbbbbrsa"><span class="toc-number">2.</span> <span class="toc-text">[HDCTF2019]bbbbbbrsa</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARSA"><span class="toc-number">2.1.</span> <span class="toc-text">çŸ¥è¯†ç‚¹ï¼šRSA</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-RSA"><span class="toc-number">3.</span> <span class="toc-text">[BJDCTF2020]RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-n%E5%9B%A0%E5%BC%8F%E5%88%86%E8%A7%A3-%E7%88%86%E7%A0%B4e"><span class="toc-number">3.1.</span> <span class="toc-text">çŸ¥è¯†ç‚¹ï¼š nå› å¼åˆ†è§£  çˆ†ç ´e</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-rsa-output"><span class="toc-number">4.</span> <span class="toc-text">[BJDCTF2020]rsa_output</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB-%E5%8F%91%E7%8E%B0n%E4%B8%80%E6%A0%B7"><span class="toc-number">4.1.</span> <span class="toc-text">çŸ¥è¯†ç‚¹ï¼šå…±æ¨¡æ”»å‡» å‘ç°nä¸€æ ·</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MRCTF2020-keyboard"><span class="toc-number">5.</span> <span class="toc-text">[MRCTF2020]keyboard</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A9%E6%89%8B%E6%9C%BA%E9%94%AE%E7%9B%98"><span class="toc-number">5.1.</span> <span class="toc-text">çŸ¥è¯†ç‚¹ï¼š9æ‰‹æœºé”®ç›˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SameMod"><span class="toc-number">6.</span> <span class="toc-text">SameMod</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Arsa-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">6.1.</span> <span class="toc-text">çŸ¥è¯†ç‚¹ï¼šrsa å…±æ¨¡æ”»å‡»</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-BabyRSA"><span class="toc-number">7.</span> <span class="toc-text">[GWCTF 2019]BabyRSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-babyrsa"><span class="toc-number">8.</span> <span class="toc-text">[WUSTCTF2020]babyrsa</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%AE%80%E5%8D%95RSA"><span class="toc-number">8.1.</span> <span class="toc-text">çŸ¥è¯†ç‚¹ï¼šç®€å•RSA</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/04/BUU-WEB-PWN/" title="BUU WEB PWN"><img data-lazy-src="/image/122.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUU WEB PWN"/></a><div class="content"><a class="title" href="/2021/08/04/BUU-WEB-PWN/" title="BUU WEB PWN">BUU WEB PWN</a><time datetime="2021-08-04T03:43:03.000Z" title="å‘è¡¨äº 2021-08-04 11:43:03">2021-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/03/BUUWEB-PWN/" title="BUUWEB PWN"><img data-lazy-src="/image/O1CN01F47VwI1CKtclK8YP3_!!63-0-lubanu.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUWEB PWN"/></a><div class="content"><a class="title" href="/2021/08/03/BUUWEB-PWN/" title="BUUWEB PWN">BUUWEB PWN</a><time datetime="2021-08-03T01:15:36.000Z" title="å‘è¡¨äº 2021-08-03 09:15:36">2021-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/02/BUUWEBPWN/" title="BUUWEBPWN"><img data-lazy-src="/image/O1CN01tnC3zS2E44SvBVaSc_!!1660208690.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUWEBPWN"/></a><div class="content"><a class="title" href="/2021/08/02/BUUWEBPWN/" title="BUUWEBPWN">BUUWEBPWN</a><time datetime="2021-08-02T03:14:38.000Z" title="å‘è¡¨äº 2021-08-02 11:14:38">2021-08-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/WEBPWN-1/" title="WEBPWN"><img data-lazy-src="/image/996.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WEBPWN"/></a><div class="content"><a class="title" href="/2021/08/01/WEBPWN-1/" title="WEBPWN">WEBPWN</a><time datetime="2021-08-01T01:57:51.000Z" title="å‘è¡¨äº 2021-08-01 09:57:51">2021-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/30/WEBPWN/" title="WEBPWN"><img data-lazy-src="/image/2239.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WEBPWN"/></a><div class="content"><a class="title" href="/2021/07/30/WEBPWN/" title="WEBPWN">WEBPWN</a><time datetime="2021-07-30T04:25:09.000Z" title="å‘è¡¨äº 2021-07-30 12:25:09">2021-07-30</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/2.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By upload</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'neutral',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: '',
      appKey: '',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://upload.love/2021/05/31/cry3/'
    this.page.identifier = '2021/05/31/cry3/'
    this.page.title = 'cry3'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://ä½ çš„disqusçš„ short-name.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(d, w, c) {
    w.ChatraID = '';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>